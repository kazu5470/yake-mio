<div class="container-fluid">
    <div class="row">
        <div class="col-md-6" id="show">
            
            <style>
            #show {
            padding-left: 125px;
            }
            </style>
            
                <table>
                    <tbody>
                        <tr>
                            <th><p>ユーザーネーム</p><%= link_to public_user_path(@post.user.id), method: :get do %>
                                                         <%= @post.user.first_name %><%= @post.user.last_name %>
                                                     <% end %>
                            </th>
                        </tr>
                        <tr>
                            <td><%= image_tag @post.post_image, size: "600x400" %></td>
                        </tr>
                        <tr>
                            
                            <td><p>タイトル</p><%= @post.title %></td>
                        </tr>
                        <tr>
                            
                            <td><p>内容</p><%= @post.body %></td>
                        </tr>
                        <tr>
                            <th>
                                <div id="star-rate<%= @post.id %>"></div>
                                    <script>
                                        $('#star-rate<%= @post.id %>').empty();
                                        $('#star-rate<%= @post.id %>').raty({
                                            size : 36,
                                            starOff : '<%= asset_path('star-off.png') %>',
                                            starOn : '<%= asset_path('star-on.png') %>',
                                            half : false,
                                            readOnly : true,
                                            score: <%= @post.star %>,
                                        });
                                    </script>
                            </th>        
                        </tr>
                        <tr>
                            <th>
                                <% if @post.favorited_by?(current_user) %>
                                    <p>
                                      <%= link_to public_post_favorites_path(@post), method: :delete do %>
                                        <%= image_tag "nightview-on.jpeg", size: "40x40" %><%= @post.favorites.count %> いいね
                                      <% end %>
                                    </p>
                                    <% else %>
                                    <p>
                                      <%= link_to public_post_favorites_path(@post), method: :post do %>
                                        <%= image_tag "nightview-off.jpeg", size: "40x40" %><%= @post.favorites.count %> いいね
                                      <% end %>
                                    </p>
                                <% end %>
                            </th>    
                        </tr>
                        <tr>
                            <%if @post.user == current_user %>
                            <td>
                                <%= link_to '投稿編集', edit_public_post_path(@post), class: "btn btn-lg btn-outline-success edit_post_#{@post.id}" %>
                            </td>
                            <td>
                                <%= link_to '投稿削除', public_post_path(@post), method: :delete, class: "btn btn-lg btn-outline-danger edit_post_#{@post.id}" %>
                            </td>
                            <% end %>
                        </tr>
                    </tbody>
                </table>
        </div>    
        
        <div id='map'></div>
        <style>
            #map {
                height: 700px;
                width: 50%;
                padding-right: ;
            }
        </style>
        
        <!--js部分-->
        <script>
        //初期マップ設定
        let map
        let marker
        function initMap(){
            geocoder = new google.maps.Geocoder()
            
            map = new google.maps.Map(document.getElementById('map'), {
                center: {lat: <%= @post.lat %>, lng: <%= @post.lng %>},
                zoom: 15,
            });
            
            marker = new google.maps.Marker({
                position: {lat: <%= @post.lat %>, lng: <%= @post.lng %>},
                map: map
            });
        }
        </script>
        
        
        <div>
          <p>コメント件数：<%= @post.post_comments.count %></p>
          <% @post.post_comments.each do |post_comment| %>
            <p><%#= image_tag post_comment.user.get_profile_image(100,100) %></p>
            <%= post_comment.user.first_name %><%= post_comment.user.last_name %>
            <%= post_comment.created_at.strftime('%Y/%m/%d') %><%= post_comment.body %>
            <% if post_comment.user == current_user %>
                <%= link_to "削除", public_post_post_comment_path(post_comment.post, post_comment), method: :delete %>
            <% end %>
          <% end %>
        </div>
        <div>
          <%= form_with url: public_post_post_comments_path(@post) do |f| %>
            <%= f.text_area :body, rows: '5', placeholder: "コメントをここに" %>
            <%= f.submit "送信する" %>
          <% end %>
        </div>   
    </div>        
</div> 
<script src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['GOOGLE_MAP_KEY'] %>&callback=initMap" async defer></script>